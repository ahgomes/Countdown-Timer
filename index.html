<!DOCTYPE html>
<html><head><link href="https://fonts.googleapis.com/css?family=Lato:300,400,900" rel="stylesheet"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><title>Loading...</title></head><body>
    <style media="screen">
        * {
            margin: 0;
        }

        body {
            background: #fff;
            font-family: 'Lato', sans-serif;
            overflow: hidden;
        }

        .h1 h1 {
            text-align: center;
            color: #182737;
            font-weight: 400;
            font-size: 85px;
            margin-top: 170px;
        }

        .h1 h1::before {
            content: "TAB";
            position: absolute;
            top: 212.5px;
            left: calc(50% - 527px);
            font-size: 40.8px;
            font-weight: 900;
            border-top-right-radius: 17px;
            border-top-left-radius: 17px;
            padding: 6.8px 34px;
            background: #f4f4f4;
            color: #2d2d2d;
        }

        .h1::after {
            content: "";
            position: absolute;
            left: calc(50% - 595px);
            width: 1190px;
            height: 6.8px;
            border-radius: 6.8px;
            background: #f4f4f4;
        }

        .jz {
            position: absolute;
            top: 272px;
            left: calc(50% - 595px);
            max-width: 1190px;
            width: 0;
            height: 6.8px;
            border-radius: 6.8px;
            background: #0ba6fb;
            transition: width 450ms ease;
        }

        .btn {
            display: -webkit-flex;
            display: flex;
            position: absolute;
            left: calc(50% - 595px);
            width: 1190px;
            height: 85px;
        }

        .btnB, .btnE {
            flex: 1;
            width: 170px;
            height: 85px;
            text-align: center;
            background: #54A4FF;
            color: #FBFCFC;
            font-size: 42.5px;
            line-height: 85px;
            border-radius: 5.1px;
            z-index: 2;
            transition: all 550ms ease;
            cursor: pointer;
        }

        .btnB:hover, .btnE:hover {
            background: #2F7FF7;
            box-shadow: 8.5px 8.5px 51px #8dcdf4;
        }

        .btnB:active, .btnE:active {
            background: #1C73D4;
            box-shadow: 8.5px 8.5px 51px #8dcdf4;
        }

        .btnB {
            margin-right: 17px;
        }

        .btnE {
            margin-left: 17px;
        }

        .notify {
            position: fixed;
            left: calc(50% - 142.5px);
            bottom: -68px;
            background: #2d2d2d;
            color: #fff;
            font-size: 15.3px;
            font-weight: 300;
            padding: 17px 0;
            border-radius: 2.55px;
            width: 285px;
            text-align: center;
            transition: bottom 500ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .beta {
            position: absolute;
            top: 60px;
            right: 60px;
            height: 40px;
            width: 40px;
            text-align: center;
            line-height: 35px;
            font-size: 30px;
            color: #E1DFEB;
            font-weight: 300;
            border-radius: 50%;
            border: 2px solid #E1DFEB;
            padding: 2px;
            transition: all 500ms ease;
            cursor: pointer;
            z-index: 2;
        }

        .beta:hover {
            color: #54A4FF;
            border-color: #54A4FF;
        }

        .betaBox {
            display: none;
            position: absolute;
            top: 20px;
            right: 110px;
            height: 90px;
            width: 240px;
            border-radius: 3px;
            background: #0987E0;
            color: #FBFCFC;
            padding: 10px 30px 25px 30px;
            box-shadow: 1.5px 1.5px 20px #8dcdf4;
            opacity: 0;
            transition: opacity 300ms ease;
            z-index: 2;
        }

        .betaBox::before {
            content: '';
            position: absolute;
            display: block;
            top: calc(50% - 15px);
            right: -15px;
            height: 0px;
            width: 0px;
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
            border-left: 15px solid #0987E0;
        }

        .betaLink {
            margin-top: 15px;
            color: #0987E0;
            background: #FAFCFD;
            border: 2px solid #FAFCFD;
            height: 40px;
            width: 178.115px;
            padding-left: 61.845px;
            border-radius: 3px;
            box-shadow: 1.5px 1.5px 10px #1A7BDB;
            cursor: pointer;
        }

        .betaLinkTitle {
            font-style: normal;
            vertical-align: top;
            width: 100%;
            height: 100%;
            font-size: 16px;
            font-weight: normal;
            -webkit-font-smoothing: antialiased;
        }

        .betaLink i {
            line-height: 40px !important;
        }

        .betaBack {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100vh;
            z-index: 1;
        }

        .footer a {
            position: fixed;
            bottom: 12px;
            left: calc(50% - 60px);
            width: 120px;
            font-size: 15px;
            font-weight: 300;
            text-align: center;
            color: #D0D1D5;
            text-decoration: none;
            z-index: -1;
        }

        .displayTime {
            position: absolute;
            top: 40px;
            left: calc(50% - 100px);
            height: 60px;
            width: 200px;
            font-size: 35px;
            line-height: 60px;
            text-align: center;
        }
    </style>
    <div class="displayTime"></div>
    <div class="beta" onclick="toggleBeta()">&#946</div>
    <div class="betaBox">
        <p>Found a bug or have any suggestions?</p>
        <div class="betaLink" onclick="window.open('http://goo.gl/t2WvDP','_blank'); toggleBeta()">
            <i class="betaLinkTitle">Comments</i>
            <i class="material-icons">&#xE89E</i>
        </div>
    </div>
    <div class="betaBack" onclick="toggleBeta()"></div>
    <div class="notify">Error</div>
    <div class="h1"><h1>Countdown Timer</h1></div>
    <div class="jz"></div>
    <br/>
    <br/>
    <div class="btn"><div class="btnB">Block</div><div class="btnE">E-Day</div></div>
    <!--<br><br><object width="100%" height="550" data="https://www.summit.k12.nj.us/uploaded/SHS_FILES/SHS_Student_Daily_Time_Schedule_Sheet1.pdf"></object>-->
    <div class="footer">
        <a href="https://github.com/ahgomes" target="_blank">Adrian H Gomes</a>
    </div>
    <script type="text/javascript">
        'use strict';

        var date;
        var x;
        var title = document.querySelector('title');
        var betaOpen = false;

        function setCookie(cname,cvalue, exdays) {
            var d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            var expires = 'expires=' + d.toGMTString();
            document.cookie = cname + '=' + cvalue + '; ' + expires;
        }

        function getCookie(cname) {
            var name = cname + '=';
            var ca = document.cookie.split(';');
            for(var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0)==' ') c = c.substring(1);
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return '';
        }

        function checkCookie() {
            var day = getCookie('dayType');
            if (day == '') {
                return 0;
            } else {
                return parseInt(day);
            }
        }

        function eraseCookie(name) {
            setCookie(name, '', -1);
        }


        window.load = dayStarted() ?  wDay(checkCookie()) : title.innerHTML = 'School isn\'t open rn';
        document.querySelector('.btnB').onclick = function(){
            if(betaOpen) toggleBeta();
            clearInterval(x);
            eraseCookie('dayType');
            if(dayStarted()) {
                notify(0);
                setCookie('dayType', '0', 1);
                wDay(0);
            }
            else notify(2);
        };

        document.querySelector('.btnE').onclick = function(){
            if(betaOpen) toggleBeta();
            clearInterval(x);
            eraseCookie('dayType');
            if(dayStarted()) {
                notify(1);
                setCookie('dayType', '1', 1);
                wDay(1);
            }
            else notify(2);
        };

        function dayStarted() {
            let d = new Date()
            var ctime = new CTime(d);
            return d.getDay() != 0 && d.getDay() != 6 && ctime.toNum() >= 7.45 && ctime.toNum() <= 14.49;
        }

        function notify(n) {
            var noteBox = document.querySelector('.notify');

            switch (n) {
                case 0:
                    noteBox.innerHTML = 'Timer has been set to Block Schedule';
                    break;
                case 1:
                    noteBox.innerHTML = 'Timer has been set to E-Day';
                    break;
                case 2:
                    noteBox.innerHTML = 'Sorry, School is not open right now';
                    break;
                default:
            }

            noteBox.style.bottom = '40px';
            window.setTimeout(function(){
                noteBox.style.bottom = '-68px';
            }, 3000);
        }

        function wDay(daytype) {
            var day = {};
            var block = {
                bells: [7.45, 8.43, 8.47, 9.45, 9.49,
                        10.47, 11.47, 12.45, 12.49, 13.47, 13.51, 14.49],
                types: ['', 'Bell', '', 'Bell', '',
                        'Lunch', '', 'Bell', '', 'Bell', '']
            }

            var eday =  {
                bells: [7.45, 8.28, 8.32, 9.15, 9.19, 10.02, 10.06,
                        10.49, 11.45, 12.28, 12.32, 13.15, 13.19, 14.02, 14.06, 14.49],
                types: ['', 'Bell', '', 'Bell', '', 'Bell', '',
                        'Lunch', '', 'Bell', '', 'Bell', '', 'Bell', '']
            }

            switch(daytype) {
                case 0:
                    day = block;
                    break;
                case 1:
                    day = eday;
                    break;
                default:
                    day = block;
            }

            var period = wPer(day);

            x = setInterval(function() {
                var ctime = new CTime(new Date());
                var timeLeft = new CTime(
                    0,
                    period.eop.min - ctime.min - (ctime.sec == 0 ? 0 : 1),
                    ctime.sec == 0 ? 0 : 60 - ctime.sec
                );

                timeLeft.min = (timeLeft.min < 0) ?
                    60 - ctime.min + period.eop.min :
                    (period.eop.hr > ctime.hr ? 60 - ctime.min + period.eop.min : timeLeft.min);

                var tabString = (timeLeft.min < 10 ? '0' : '') + timeLeft.min + ':' +
                                (timeLeft.sec < 10 ? '0' : '') + timeLeft.sec;

                var toSixty =  ((period.eop.hr * 60) + period.eop.min) - ((period.prev.hr * 60) + period.prev.min);
                var barLength = (timeLeft.min + timeLeft.sec / 100) / toSixty;
                barLength = (1 - barLength) * 1190;
                barLength = (barLength < 0) ? 0 : barLength;

                document.querySelector('.jz').style.width = barLength + 'px';

                if(period.eop == null && h > 12) {
                    title.innerHTML = 'School is Over';
                } else if(period.eop == null && h < 12) {
                    title.innerHTML = 'School hasn\'t started';
                } else {
                    title.innerHTML = period.type + ' ' + tabString;
                    document.querySelector('.displayTime').innerHTML = '<strong>' + period.type + '</strong>' + ' ' + tabString;
                }

                if (timeLeft.min == 0 && timeLeft.sec == 0) {
                    clearInterval(x);
                    wDay(daytype);
                }
            }, 1000);
        }

        function wPer(daylist) {
            var ctime = new CTime(new Date());
            if(ctime.toNum() < daylist.bells[0]) return null;
            for(let i = 0; i < daylist.bells.length; i++) {
                if (ctime.toNum() < daylist.bells[i]) {
                    return {
                        eop: CTimeFromNum(daylist.bells[i]),
                        type: daylist.types[i - 1],
                        prev: CTimeFromNum(daylist.bells[i - 1])
                    }
                }
            }
            return null;
        }

        function CTime(a, b, c) {
            if(b === undefined && c === undefined) {
                this.hr  = a.getHours();
                this.min = a.getMinutes();
                this.sec = a.getSeconds();
            } else {
                this.hr = a;
                this.min = b;
                this.sec = c || 0;
            }

            this.toNum = function() {
                return this.hr + this.min / 100;
            }
        }

        function CTimeFromNum(num) {
            var m = Math.round(num * 100) % 100;
            var h = num - m / 100;
            return new CTime(h, m);
        }

        function toggleBeta() {
            var box = document.querySelector('.betaBox').style;
            var back = document.querySelector('.betaBack').style;
            if(betaOpen) {
                box.opacity = '0';
                setTimeout(function() { box.display = 'none'; back.display = 'none'; }, 150);
                betaOpen = false;
            } else {
                box.display = 'block';
                back.display = 'block';
                setTimeout(function() { box.opacity = '1'; }, 10);
                betaOpen = true;
            }

        }

    </script>
</body></html>
